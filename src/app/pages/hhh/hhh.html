<!-- Header -->
<div class="h-screen flex bg-grey-100">


  <!-- ================= SIDEBAR ================= -->
<!-- ================= SIDEBAR ================= -->
<aside class="w-64 bg-white border-l hidden md:block">
  <mat-nav-list class="text-sm">

    <!-- Title -->
    <div class="px-4 py-3 font-semibold text-gray-500">
      Chapters
    </div>

    <!-- Chapter Items -->
    <a
      mat-list-item
      *ngFor="let chapter of chapters"
      (click)="setActiveChapter(chapter)"
      class="mx-2 my-0.5 flex items-center gap-3 rounded-md px-3 py-2 cursor-pointer
             transition-colors
             hover:bg-gray-100"
      [ngClass]="{
        'bg-emerald-50 border-l-4 border-emerald-500': chapter.active
      }"
    >
      <!-- Number Circle -->
      <span
        class="flex h-7 w-7 items-center justify-center rounded-full border text-xs font-semibold
               border-gray-400 text-gray-700"
        [ngClass]="{
          'bg-emerald-500 border-emerald-500 text-white': chapter.active
        }"
      >
        {{ chapter.id }}
      </span>

      <!-- Label -->
      <span
        class="text-sm leading-tight text-gray-700"
        [ngClass]="{
          'text-emerald-600 font-semibold': chapter.active
        }"
      >
        {{ chapter.label }}
      </span>
    </a>

    <!-- Collapse -->
    <div
      class="mt-2 flex items-center gap-2 px-4 py-3 text-sm font-medium
             text-emerald-600 border-t border-gray-200 cursor-pointer"
    >
      <mat-icon class="text-base">chevron_left</mat-icon>
      Collapse
    </div>

  </mat-nav-list>
</aside>



<main class="flex-1 p-6 overflow-auto">



<div class="mb-6">
  <h1 class="text-2xl font-semibold text-green-900">
    {{ sectionTitle }}
  </h1>
</div>

<mat-accordion class="max-w-5xl flex flex-col gap-4">

  <mat-expansion-panel
    *ngFor="let panel of panels"
    [expanded]="panel.expanded"
    class="mat-elevation-z0">

    <mat-expansion-panel-header togglePosition="before">
      <mat-panel-title class="font-semibold title-indent">
        {{ panel.title }}
      </mat-panel-title>
    </mat-expansion-panel-header>

    <!-- EMPTY PANEL -->
    <ng-container *ngIf="panel.type === 'empty'">
      <!-- future content -->
    </ng-container>

    <!-- RADIO PANEL -->
    <ng-container *ngIf="panel.type === 'radio'">

      <div class="p-4 space-y-4">

        <p class="text-sm text-gray-600">
          {{ panel.description }}
        </p>

        <mat-radio-group
          class="flex flex-col gap-3"
          [value]="panel.selectedValue"
          (change)="onRadioChange(panel, $event.value)">

          <mat-radio-button
            *ngFor="let option of panel.options"
            [value]="option.value">

            {{ option.label }}

          </mat-radio-button>
        </mat-radio-group>

        <mat-card class="bg-gray-50 border mat-elevation-z0">
          <mat-card-header>
            <mat-card-title class="text-sm font-semibold text-orange-600">
              PREVIEW
            </mat-card-title>
          </mat-card-header>

          <mat-card-content class="text-sm text-gray-600">
            {{ panel.previewText }}
          </mat-card-content>
        </mat-card>

      </div>

    </ng-container>

  </mat-expansion-panel>

</mat-accordion>

--

<div class="max-w-5xl space-y-6">

  <!-- Section Title -->
  <h2 class="text-lg font-semibold text-green-800">
    {{ methodOfExamination.title }}
  </h2>

  <mat-accordion>

    <mat-expansion-panel
      *ngFor="let section of methodOfExamination.sections"
      [expanded]="section.expanded"
      class="mat-elevation-z0 white-panel"
    >

      <mat-expansion-panel-header togglePosition="before">
        <mat-panel-title class="font-semibold title-indent">
          {{ section.id }} {{ section.title }}
        </mat-panel-title>
      </mat-expansion-panel-header>

      <div class="p-2 space-y-4">

        <!-- Related link -->
        <p *ngIf="section.relatedLink" class="text-sm text-gray-600">
          Related links:
          <a
            [href]="section.relatedLink.url"
            class="text-green-600 underline inline-flex items-center gap-1"
          >
            {{ section.relatedLink.text }}
            <mat-icon class="text-sm">open_in_new</mat-icon>
          </a>
        </p>

        <!-- Section Items -->
        <ng-container *ngFor="let item of section.items">

          <!-- TEXT ONLY -->
          <h4
            *ngIf="item.type === 'text'"
            class="font-semibold title-indent"
          >
            {{ item.id }} {{ item.title }}
          </h4>

          <!-- GROWING CYCLE -->
          <div *ngIf="item.type === 'cycle'" class="space-y-2">
            <h4 class="font-semibold title-indent">
              {{ item.id }} {{ item.title }}
            </h4>

            <mat-radio-group
              [(ngModel)]="form.growingCycle"
              class="flex flex-col gap-2"
            >
              <mat-radio-button
                *ngFor="let opt of item.options"
                [value]="opt.value"
              >
                {{ opt.label }}
              </mat-radio-button>
            </mat-radio-group>

            <div
              *ngIf="form.growingCycle === 'two'"
              class="ml-6 flex flex-col gap-2"
            >
              <mat-radio-button
                *ngFor="let sub of item.subOptions"
                [value]="sub.value"
                [(ngModel)]="form.cycleType"
              >
                {{ sub.label }}
              </mat-radio-button>
            </div>
          </div>

          <!-- FRUIT SECTION -->
          <div *ngIf="item.type === 'fruit'" class="space-y-3">
            <h4 class="font-semibold title-indent">
              {{ item.id }} {{ item.title }}
            </h4>

            <p class="text-sm text-gray-700">
              {{ item.question }}
            </p>

            <mat-radio-group
              [(ngModel)]="form.satisfactoryCrop"
              class="flex gap-6"
            >
              <mat-radio-button value="yes">Yes</mat-radio-button>
              <mat-radio-button value="no">No</mat-radio-button>
            </mat-radio-group>

            <mat-radio-group
              [(ngModel)]="form.fruitType"
              class="flex flex-col gap-2 mt-2"
            >
              <mat-radio-button
                *ngFor="let f of item.fruitTypes"
                [value]="f.value"
              >
                {{ f.label }}
                <span class="text-green-600 font-medium">
                  ({{ f.code }})
                </span>
              </mat-radio-button>
            </mat-radio-group>
          </div>

        </ng-container>

      </div>
    </mat-expansion-panel>

  </mat-accordion>
</div>

<div class="max-w-5xl flex flex-col gap-4">

  <!-- ================= PREVIEW HEADING ================= -->
  <h4 class="font-semibold title-indent">
    {{ previewSection.heading }}
  </h4>

  <!-- ================= PREVIEW CARD ================= -->
  <mat-card class="bg-gray-50 mat-elevation-z0 border">
    <mat-card-header>
      <mat-card-title class="text-sm font-semibold text-orange-600">
        PREVIEW
      </mat-card-title>
    </mat-card-header>

    <mat-card-content class="text-sm text-gray-700 space-y-3">

      <!-- Paragraphs -->
      <p *ngFor="let text of previewSection.paragraphs">
        {{ text }}
      </p>

      <!-- Inline input paragraph -->
      <p class="leading-6">
        3.1.3 In particular, it is essential that the
        <input
          type="text"
          [(ngModel)]="previewSection.inlineInputText"
          class="inline-mat-input"
        />
        produce a satisfactory crop of fruit in each of the two growing cycles.
      </p>

    </mat-card-content>
  </mat-card>

  <!-- ================= REUSABLE EXPANSION PANELS ================= -->
  <mat-expansion-panel
    *ngFor="let panel of simplePanels"
    class="mat-elevation-z0 border-b"
  >
    <mat-expansion-panel-header togglePosition="before">
      <mat-panel-title class="font-semibold title-indent">
        {{ panel.title }}
      </mat-panel-title>
    </mat-expansion-panel-header>
  </mat-expansion-panel>

</div>


</main>


</div>
